---
title: "Project Kalayaan 2 - 100 MW Wind Farm"
subtitle: "Probabilistic & Economic Selection of Step-up Transformers"
date: "`r Sys.Date()`"
author: Jorge Thomas
format:    
    html:
      self-contained: true
      code-fold: true
      df-print: tibble
      code-summary: "Show the code"
      grid: 
        margin-width: 350px
reference-location: margin 
bibliography: references.bib
---


::: {#fig-intro layout-ncol="1"}

![Credit: Siemens Gamesa](./imgs/Balaoi-Caunayan-Wind-Farm.webp){width="100%"}

 The Balaoi & Caunayan Wind Farm is an 160 MW onshore project located in the province of Ilocos Norte, Philippines.
:::

```{r}
#| label: setup
#| include: false
#| warning: false

library(tidyverse)
library(convertr) # https://cran.r-project.org/web/packages/convertr/convertr.pdf
convertr::convert(1:10,'1/degC','1/K')
source("./tools/jthomfuncs.r")
theme_set(jthomggtheme)
```

# On-Site Wind Profile

On June the 30<sup>th</sup> of 2021 began the measuring campaign for collecting on-site wind speed and other important weather-related variables with a 10-min step resolution.

There are 61 variables named:

```{r}
#| label: extract
#| echo: false
#| output: true
#| warning: false

klywind <- read_csv("./data/metmast_01_21-months.csv", show_col_types = FALSE)

klywind <- 
    klywind |>
    rename_with(~ str_remove_all(.x, "\\[.*\\]|\\s+"))

klywind |>
    select(-datetime)|>
    colnames()
```

Abbreviations indicate the following:

- WS: Wind Speed [m/s]
- PR: Pressure [mbar]
- WD: Wind Direction [°]
- RH: Relative Humidity [%]
- TEM: Ambient Temperature [°C]

It's important to keep all units within the **SI**, therefore I will convert the following units:

- PR: Pressure [mbar] --> [Pa]
- TEM: Ambient Temperature [°C] --> [K]

```{r}
#| label: units
#| include: false
#| eval: true

# Convert units to SI

klywind <- 
    klywind |>
    mutate(across(contains("PR"), ~ convertr::convert(., "mbar", "Pa"))) |>
    mutate(across(contains("TEM"), ~ convertr::convert(., "degC", "K")))

klywind |>
    select(contains("TEM")) |>
    glimpse()

```


**Temperature** $(T)$, **pressure** $(p)$ and **relative humidity** $(\phi)$ are important to calculate the **humid air density**[^1] $(\rho_h)$, which affects the output power of wind turbines $P_{out}$; lower density means lower power output.

[^1]: The more water vapour in the air, the less is its total density; this seems counter-intuitive.

${\rho_h={\frac{p_d}{R_{d}T}} + {\frac{p_v}{R_{v}T}}={\frac {p_{\text{d}}M_d+p_{v}M_{v}}{RT}}}$


R, universal gas constant, 8.31446 J/(K·mol)

${p_{v}=\phi p_{sat}}$

where:

${p_{v}}$, vapor pressure of water

$\phi$, relative humidity (0.0–1.0)

$p_{sat}$, saturation vapor pressure

Tetens equation to calculate the saturation vapour pressure of water over liquid
https://en.wikipedia.org/wiki/Tetens_equation

${p_{sat} = 6.1078\times \exp({\frac {17.5T}{T+237.3}})}$

where temperature $T$ is in degrees Celsius (°C) and saturation vapor pressure $p_{sat}$ is in kilopascals (kPa). 

The partial pressure of dry air 

${p_{d}}$ is found considering partial pressure, resulting in:

${\displaystyle p_{\text{d}}=p-p_{\text{v}}}$

where 

$p$ simply denotes the observed absolute pressure.


## Wind Turbine Output Power

$P_{out} = C_p \frac{1}{2} \rho A v^3$
